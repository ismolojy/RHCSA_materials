1) Загрузка, перезагрузка и выключение системы в обычном режиме

reboot время - перезагрузка, по умолчанию 1 минута
reboot now - сейчас
shutdown -r +5 Перезагрузка через 5 минут!!! - перезагрузка через 5 минут с выводом сообщения
-p - выключение
-c - отмена
shutdown -r 00:00 - перезагрузка в определенное время
halt - остановка системы
shutdown -h - остановка системы
init 0 - выключение
init 6 - перезагрузка

systemd - это подсистема инициализации и управления службами в Linux, фактически вытеснившая в 2010-е годы
традиционную подсистему init. Основная особенность — интенсивное распараллеливание запуска служб в процессе
загрузки системы, что позволяет существенно ускорить запуск операционной системы.

.target - юниты - савокупность программ, которые запускаются при обращении к определенному юниту
Например reboot.target
Файлы таргет-юнитов расположены в директории /usr/lib/systemd/system


2) Загрузка систем в различные целевые объекты вручную
systemctl -t help - показывает все типы юнитов в системе
В директории /usr/lib/sytemd/system лежат юниты
systemctl list-dependencies имя_юнита - вывести весь список зависимостей для данного юнита
systemctl get-default - выводит таргет юнит по умолчанию
Таргет юниты - graphical.target, multi-user.target, emrgency.target, resque.target
systemctl isolate имя_юнита - переключение мужду таргет юнитами
systemctl set-default имя_юнита - установка таргет юнита по умолчанию,
по сути создает симлинк дефолт таргета на файл нужного таргета
Симлинк лежит в папке /etc/systemd/system
При загрузке системы мы можем указать нужный нам таргет юнит:
1) при выборе ядра, в строке с нужной версией нажимаем клавишу "e"
2) листаем до строчки, начинающейся с linux16
3) в конце строки дописываем "systemd.unit=имя_таргета"
4) нажимаем "ctrl+x" для применения параметров
Работает только на одну загрузку.

systemctl list-units --type=service
 	Показать все активные сервисные юниты (тот же результат, что и предыдущая команда)
systemctl list-units --type=service --all
 	Показать как неактивные так и активные сервисные юниты

Использование команды systemctl list-unit-files
Для того, чтобы посмотреть список ВСЕХ доступных служб, сервисов, демонов, или по правильному - юнитов,
нужно ввести следующую команду:
systemctl list-unit-files
Если нужно посмотреть какие юниты включены в системе, следует скомбинировать данную команду с командой grep:
systemctl list-unit-files | grep enabled
Для того, чтобы отобразить список запущенных в системе юнитов systemd, поменяем параметр поиска через grep:
systemctl list-unit-files | grep running

3) Прерывание процесса загрузки с целью получения доступа к системе
    1. при выборе ядра, в строке с нужной версией нажимаем клавишу "e"
    2. листаем до строчки, начинающейся с linux16
    3. в конце строки вводим параметр rd.break
    4. нажимаем "ctrl+x" для применения параметров
    5. перемонтируем корневую систему для чтения и записи командой
    mount -oremount,rw /systoot
    6. меняем корневую директорию командой
    chroot /sysroot
    7. делаем свои грязные штуки (например меняем пароль)
    8. делаем файлик, для selinux
    touch /.autorelabel
    9. дважды exit для загрузки системы
Изначально мы монтируемся в общую директорию, а sysroot доступен только для чтения.


4) Идентификация интенсивных процессов по загрузке CPU/Memory и завершениие их

Команды pgrep и pkill
ps - вывод информации о системе
ps aux - вывод информации о всез процессах и из статусе
pgrep gnome = ps aux | grep gnome
pgrep httpd - выводит id процессов
pgrep httpd -l - выводит id процессов и имя
-u имя_пользователя - выводит процессы нужного пользователя
-v - выдает обратный результат (для исключения чего то)
kill -l - таблица сигналов
по умолчанию 15 сигнал
9 сигнал убивает напрочь
w - выводит список подключенных терминалов
pkill -t имя_терминала - завершает процессы для выбранного терминала

& запуск процесса в фоновом режиме

kill -19 %1 - приостанавливает работу процеса (ctrl+z)
kill -18 %1 - возобновляет
kill -15 - завершает процесс

ps - выводит список процессов, запущенных на данном трминале
ps x - процессы текущего пользователя
ps ax - все процессы системы
ps u - выводит дополнительную информации по процессам
ps axo нужные поля через запятую - выводит нужные поля в таблице

5) Планирование процессов
nice - приоритет процессов в диапазоне от -20 до 19
-20 - самый высокий приоритет
renice -n -20 PID - изменяет приоритет
renice -n -20 $(pgrep httpd) - изменяет приоритет для всех процессов httpd
nice -n -N процесс - задает приоритет процессу, при создании его

Средняя нагрузка и программа top
w и uptime - выводят много полезной инфы, в том числе среднюю нагрузку процессора
информация о процессорах системы лежит в файле /proc/cpuinfo
cat /proc/cpuinfo | grep "model name" | wc -l - выводит количество процессоров
wc -l - считает количество ответов предыдущей команды
ping -g -q имя_узла - зафлудить узел
top - диспетчер процессов
Горячие клавиши топ:
m - сортировка по памяти
с - сортировка по нагрузке на процессор
l - сортировка по времени работы
r - изменить приоритет
k - отправить сигнал процессу

6,7,8) Журналы системы
Логи системы в /var/log
Jornald отвечает за логирование системы, управляется journalctl
По умолчанию хранит только логи последнего запуска системы
ЧТобы хранил все логи, нужно изменить строку в конфиге /etc/systemd/journald.conf:
Storage=persistent
Перезапуск journald:
systemctl restart systemd-journald

journalctl -n N - выводит последние N строк журнала (по умолчанию 10)
-x - с подробным описание процессов

За определение уровня важности сообщения отвечает rsyslog
Конфиг лежит в /etc/rsyslog.conf

journalctl -p степень важности - выводит все сообщения с этим уровнем важности
systemd-analyze - выводит информацию о времени загрузки системы
systemd-analyze blame - подробно по всем процессам

9) Запуск, остановка и проверка состояния сетевых служб
stop start restart status enable

10) Безопасная передача файлов между системами
scp и sftp
22 порт
scp источник пользователь@назначение:путь
sftp устанавливает постоянное соединение
sftp пользователь@адрес
get имя файла - скачивает с удаленной машины
put имя файла - закачивает