4. Настройка локального хранилища
mbr: максимум 4 первичных раздела по 2 ТБ
gpt: максимум 128 первичных разделов по 9,4 Зетабайт
Для mbr используется утилита fdisk
Для GPT используется утилита gdisk
mkfs - утилита для установки файловой системы
mount - монтирование разделов в точку
df -h - список всех разделов смонтированных
partprobe для обновления информации о разделах системы(после удаления раздела)
blkid - выводит uuid и другую инфу о разделах жесткого диска
mount -U uuid_раздела /точка монтирования - монтирование по UUid
монтирование по UUid более надежное
wipefs /dev/sdb - полностью стирает таблицу разделов для жесткого диска


Логический раздел это савокупность физических разделов с одной файловой системой
lvm - утилита для работы с локальными разделами
метка должна быть linux LVM
pvcreate /dev/sdb1 - ииспользуется для определения раздела, как физического
Надо делать перед объединением в логический раздел
pvdisplay - подробная информация о физических разделах
vgcreate volgroup1 /dev/sdb1 /dev/sdc1 - обьединение разделов в группу
vпdisplay - подробная информация о группах разделов
lvcreate -n localvol1 -L 11G volgroup1 - создает локальный раздел localvol1 размеров 11 ГБ
lvdisplay - подробная информация о локальных разделах
lvremove /dev/volgroup/localvol1 - удалить локальный раздел

Для работы с метками дисков используются специальные утилиты:
для xfs это xfs_admin
для ext4 - это tune2fs
xfs_admin -L filesystem1 /dev/sdb1
tune2fs -L filesystem2 /dev/sdb2
tune2fs -l /dev/sdb1 - посмотреть метку и другую инфу
xfs_admin -l /dev/sdb1 - посмотреть метку и другую инфу

mount -L filesystem1 /mnt/dir1 - монтирует по метке
mount действует ло перезагрузки
файл /etc/fstab используется для указания разделов, которые должны быть смонтированы при старте системы
mount -a - перечитывает файл /etc/fstab

free -mh - выводит информации об оперативной памяти и подкачке
mkswap /dev/swapgroup/swap - установить раздел swap, как раздел подкачки
swapon /dev/swapgroup/swap - включить раздел подкачки
swapoff /dev/swapgroup/swap - выключить раздел подкачки
Чтоб работало постоянно, надо добавить в fstab
swapon -a - включить все свапы из fstab
swapoff -a - выключить все свапы

Если делаем раздел физический, то указываем метку 82 в fdisk или gdisk
swapon -s - информация о разделах подкачки
cat /proc/swaps - информация о разделах подкачки


getfacl имя_файла - выводит подробные права
setfacl -m u:user:rw file1 - дает права чтения и запись для определенного доступа
setfacl -m m::r file1 - меняем маску для файла
setfacl -m m::- file1 - меняем маску на нулевую
setfacl -m g:group1:rw file 1 - меняем маску для группы
setfacl -d -m u:user:rw dir1 - права применяются на все новые файлы в директории(наследование)
setfacl -m u:user:rw dir1 - дает права на папку для определенного юзера
setfacl -x или setfacl --remove-default dir 1 - убирает наследование
setfacl -x u:user dir1 - удаляет права доступа
getfacl file1 | setfacl --set-file=- file2 - делает права файла 2 такие же как у файла 1


